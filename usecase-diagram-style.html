<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use Case Diagram - H·ªá th·ªëng Th∆∞∆°ng m·∫°i ƒêi·ªán t·ª≠</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
        }

        .controls {
            background: #f8f9fa;
            padding: 12px;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 6px 14px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }

        .btn-primary { background: #667eea; color: white; }
        .btn-success { background: #10b981; color: white; }
        .btn-info { background: #3b82f6; color: white; }
        .btn-warning { background: #f59e0b; color: white; }

        .diagram-container {
            padding: 30px;
            overflow: auto;
            background: #fafafa;
        }

        .diagram-wrapper {
            width: 1400px;
            height: 1100px;
            margin: 0 auto;
            position: relative;
            background: white;
            border-radius: 8px;
            padding: 20px;
        }

        /* System Boundary */
        .system-boundary {
            position: absolute;
            border: 3px solid #8B4513;
            border-radius: 10px;
            background: #FFF9E6;
        }

        .system-title {
            position: absolute;
            top: 8px;
            left: 15px;
            font-weight: bold;
            font-size: 13px;
            color: #654321;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .folder-icon {
            width: 20px;
            height: 16px;
            background: #F4A460;
            border-radius: 2px;
            position: relative;
        }

        .folder-icon::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 0;
            width: 12px;
            height: 6px;
            background: #F4A460;
            border-radius: 2px 2px 0 0;
        }

        /* Actor Styles */
        .actor {
            position: absolute;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .actor:hover {
            transform: scale(1.05);
        }

        .actor-figure {
            margin: 0 auto;
        }

        .actor-head {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid #4A90E2;
            background: white;
            margin: 0 auto;
        }

        .actor-body {
            width: 3px;
            height: 35px;
            background: #4A90E2;
            margin: 0 auto;
        }

        .actor-arms {
            position: relative;
            height: 3px;
            width: 45px;
            background: #4A90E2;
            margin: -18px auto 0;
        }

        .actor-legs {
            position: relative;
            width: 45px;
            height: 28px;
            margin: 0 auto;
        }

        .actor-legs::before,
        .actor-legs::after {
            content: '';
            position: absolute;
            width: 3px;
            height: 28px;
            background: #4A90E2;
        }

        .actor-legs::before {
            left: 8px;
            transform: rotate(-12deg);
        }

        .actor-legs::after {
            right: 8px;
            transform: rotate(12deg);
        }

        .actor-name {
            margin-top: 5px;
            font-weight: bold;
            font-size: 12px;
            color: #2c3e50;
        }

        /* Use Case Styles */
        .usecase {
            position: absolute;
            background: #FFF9E6;
            border: 2.5px solid #8B4513;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            padding: 8px;
            box-shadow: 0 2px 4px rgba(139, 69, 19, 0.15);
        }

        .usecase:hover {
            background: #FFF4D6;
            transform: scale(1.08);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.25);
            z-index: 10;
        }

        .usecase-text {
            font-size: 12px;
            font-weight: 600;
            color: #2c3e50;
            line-height: 1.3;
        }

        /* SVG Lines */
        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .connection {
            stroke: #666;
            stroke-width: 1.5;
            fill: none;
        }

        .connection-dashed {
            stroke: #888;
            stroke-width: 1.5;
            stroke-dasharray: 5, 3;
            fill: none;
        }

        .connection-include {
            stroke: #666;
            stroke-width: 1.8;
            stroke-dasharray: 6, 4;
            fill: none;
        }
        
        .arrow-text {
            font-size: 10px;
            fill: #666;
            font-style: italic;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            max-width: 250px;
        }

        .tooltip.show {
            opacity: 1;
        }

        /* Highlight mode */
        .highlight-mode .usecase {
            opacity: 0.3;
        }

        .highlight-mode .usecase.active {
            opacity: 1;
        }

        .highlight-mode .actor {
            opacity: 0.3;
        }

        .highlight-mode .actor.active {
            opacity: 1;
        }

        .highlight-mode .connection {
            opacity: 0.15;
        }

        .highlight-mode .connection.active {
            opacity: 1;
            stroke-width: 2.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Use Case Diagram</h1>
            <p>H·ªá th·ªëng Th∆∞∆°ng m·∫°i ƒêi·ªán t·ª≠ Thi·∫øt b·ªã C√¥ng ngh·ªá</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="resetView()">üîÑ Reset</button>
            <button class="btn btn-success" onclick="highlightActor('guest')">üë§ Kh√°ch</button>
            <button class="btn btn-info" onclick="highlightActor('customer')">üõí Ng∆∞·ªùi d√πng</button>
            <button class="btn btn-warning" onclick="highlightActor('admin')">‚öôÔ∏è Qu·∫£n tr·ªã vi√™n</button>
            <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è In</button>
        </div>

        <div class="diagram-container">
            <div class="diagram-wrapper" id="diagramWrapper">
                <svg id="connectionSvg" width="1400" height="1100"></svg>

                <!-- System Boundary -->
                <div class="system-boundary" style="top: 50px; left: 180px; width: 1040px; height: 1000px;">
                    <div class="system-title">
                        <div class="folder-icon"></div>
                        <span>H·ªá th·ªëng Th∆∞∆°ng m·∫°i ƒêi·ªán t·ª≠</span>
                    </div>
                </div>

                <!-- ACTORS -->
                <!-- Ch·ªß tr·ªç (Guest) - Left -->
                <div class="actor" id="actor-guest" style="top: 120px; left: 50px;" data-actor="guest">
                    <div class="actor-figure">
                        <div class="actor-head"></div>
                        <div class="actor-body"></div>
                        <div class="actor-arms"></div>
                        <div class="actor-legs"></div>
                    </div>
                    <div class="actor-name">Kh√°ch</div>
                </div>

                <!-- Ng∆∞·ªùi d√πng (Customer) - Left -->
                <div class="actor" id="actor-customer" style="top: 520px; left: 50px;" data-actor="customer">
                    <div class="actor-figure">
                        <div class="actor-head"></div>
                        <div class="actor-body"></div>
                        <div class="actor-arms"></div>
                        <div class="actor-legs"></div>
                    </div>
                    <div class="actor-name">Ng∆∞·ªùi d√πng</div>
                </div>

                <!-- Qu·∫£n tr·ªã vi√™n (Admin) - Right -->
                <div class="actor" id="actor-admin" style="top: 420px; right: 50px;" data-actor="admin">
                    <div class="actor-figure">
                        <div class="actor-head"></div>
                        <div class="actor-body"></div>
                        <div class="actor-arms"></div>
                        <div class="actor-legs"></div>
                    </div>
                    <div class="actor-name">Qu·∫£n tr·ªã vi√™n</div>
                </div>

                <!-- USE CASES - Theo ƒë√∫ng layout h√¨nh -->
                
                <!-- Row 1: ƒêƒÉng k√Ω & X√°c th·ª±c jwt -->
                <div class="usecase" id="uc-dangky" style="top: 85px; left: 350px; width: 180px; height: 75px;" 
                     data-actor="guest" data-desc="ƒêƒÉng k√Ω t√†i kho·∫£n m·ªõi">
                    <div class="usecase-text">ƒêƒÉng k√Ω</div>
                </div>

                <div class="usecase" id="uc-xacthuc" style="top: 85px; left: 630px; width: 150px; height: 75px;" 
                     data-actor="guest" data-desc="X√°c th·ª±c JWT token">
                    <div class="usecase-text">X√°c th·ª±c jwt</div>
                </div>

                <!-- Row 2: ƒêƒÉng nh·∫≠p -->
                <div class="usecase" id="uc-dangnhap" style="top: 175px; left: 350px; width: 180px; height: 75px;" 
                     data-actor="guest" data-desc="ƒêƒÉng nh·∫≠p v√†o h·ªá th·ªëng">
                    <div class="usecase-text">ƒêƒÉng nh·∫≠p</div>
                </div>

                <!-- Row 3: Th√¥ng tin -->
                <div class="usecase" id="uc-thongtin" style="top: 265px; left: 360px; width: 120px; height: 65px;" 
                     data-actor="guest" data-desc="Nh·∫≠p th√¥ng tin">
                    <div class="usecase-text">Th√¥ng tin</div>
                </div>

                <!-- Row 4: T·∫°o b√†i ƒëƒÉng, H√¨nh ·∫£nh, Ng√†y ƒëƒÉng -->
                <div class="usecase" id="uc-taobaidang" style="top: 305px; left: 220px; width: 150px; height: 75px;" 
                     data-actor="guest" data-desc="T·∫°o b√†i ƒëƒÉng m·ªõi">
                    <div class="usecase-text">T·∫°o b√†i ƒëƒÉng</div>
                </div>

                <div class="usecase" id="uc-hinhanh" style="top: 305px; left: 530px; width: 120px; height: 65px;" 
                     data-actor="guest" data-desc="Th√™m h√¨nh ·∫£nh">
                    <div class="usecase-text">H√¨nh ·∫£nh</div>
                </div>

                <div class="usecase" id="uc-ngaydang" style="top: 330px; left: 690px; width: 120px; height: 65px;" 
                     data-actor="guest" data-desc="Ng√†y ƒëƒÉng b√†i">
                    <div class="usecase-text">Ng√†y ƒëƒÉng</div>
                </div>

                <!-- Row 5: Duy·ªát/ch∆∞a duy·ªát -->
                <div class="usecase" id="uc-duyetchuaduyet" style="top: 395px; left: 530px; width: 150px; height: 70px;" 
                     data-actor="admin" data-desc="Duy·ªát ho·∫∑c ch∆∞a duy·ªát b√†i ƒëƒÉng">
                    <div class="usecase-text">Duy·ªát/ch∆∞a duy·ªát</div>
                </div>

                <!-- Row 6: Xem tr·∫°ng th√°i b√†i ƒëƒÉng & S·ª≠a/x√≥a -->
                <div class="usecase" id="uc-xemtrangthai" style="top: 470px; left: 220px; width: 180px; height: 75px;" 
                     data-actor="customer" data-desc="Xem tr·∫°ng th√°i b√†i ƒëƒÉng">
                    <div class="usecase-text">Xem tr·∫°ng th√°i b√†i ƒëƒÉng</div>
                </div>

                <div class="usecase" id="uc-suaxoa" style="top: 480px; left: 540px; width: 110px; height: 65px;" 
                     data-actor="customer admin" data-desc="S·ª≠a ho·∫∑c x√≥a b√†i ƒëƒÉng">
                    <div class="usecase-text">S·ª≠a/x√≥a</div>
                </div>

                <!-- Row 7: Duy·ªát b√†i ƒëƒÉng -->
                <div class="usecase" id="uc-duyetbaidang" style="top: 555px; left: 390px; width: 200px; height: 75px;" 
                     data-actor="admin" data-desc="Duy·ªát b√†i ƒëƒÉng">
                    <div class="usecase-text">Duy·ªát b√†i ƒëƒÉng</div>
                </div>

                <!-- Row 8: X√≥a b√†i ƒëƒÉng -->
                <div class="usecase" id="uc-xoabaidang" style="top: 640px; left: 390px; width: 160px; height: 75px;" 
                     data-actor="admin" data-desc="X√≥a b√†i ƒëƒÉng">
                    <div class="usecase-text">X√≥a b√†i ƒëƒÉng</div>
                </div>

                <!-- Row 9: ·∫¢nh -->
                <div class="usecase" id="uc-anh" style="top: 715px; left: 430px; width: 100px; height: 60px;" 
                     data-actor="customer" data-desc="Qu·∫£n l√Ω ·∫£nh">
                    <div class="usecase-text">·∫¢nh</div>
                </div>

                <!-- Row 10: Xem b√†i ƒëƒÉng & Gi√° -->
                <div class="usecase" id="uc-xembaidang" style="top: 740px; left: 220px; width: 150px; height: 75px;" 
                     data-actor="customer" data-desc="Xem danh s√°ch b√†i ƒëƒÉng">
                    <div class="usecase-text">Xem b√†i ƒëƒÉng</div>
                </div>

                <div class="usecase" id="uc-gia" style="top: 740px; left: 630px; width: 100px; height: 60px;" 
                     data-actor="customer" data-desc="Xem gi√°">
                    <div class="usecase-text">Gi√°</div>
                </div>

                <!-- Row 11: M√¥ t·∫£/v·ªã tr√≠ -->
                <div class="usecase" id="uc-motavitri" style="top: 810px; left: 420px; width: 140px; height: 65px;" 
                     data-actor="customer" data-desc="M√¥ t·∫£ v√† v·ªã tr√≠">
                    <div class="usecase-text">M√¥ t·∫£/v·ªã tr√≠</div>
                </div>

                <!-- Row 12: T√¨m ki·∫øm -->
                <div class="usecase" id="uc-timkiem" style="top: 895px; left: 250px; width: 130px; height: 65px;" 
                     data-actor="customer" data-desc="T√¨m ki·∫øm b√†i ƒëƒÉng">
                    <div class="usecase-text">T√¨m ki·∫øm</div>
                </div>

                <!-- Row 13: L·ªçc theo gi√° ph√≤ng -->
                <div class="usecase" id="uc-loctheogiaphong" style="top: 905px; left: 450px; width: 180px; height: 75px;" 
                     data-actor="customer" data-desc="L·ªçc theo gi√° ph√≤ng">
                    <div class="usecase-text">L·ªçc theo gi√° ph√≤ng</div>
                </div>

                <!-- Row 14: T√¨m theo khu v·ª±c -->
                <div class="usecase" id="uc-timtheokhuvuc" style="top: 985px; left: 450px; width: 180px; height: 75px;" 
                     data-actor="customer" data-desc="T√¨m theo khu v·ª±c">
                    <div class="usecase-text">T√¨m theo khu v·ª±c</div>
                </div>

            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        const usecases = document.querySelectorAll('.usecase');
        const actors = document.querySelectorAll('.actor');
        const tooltip = document.getElementById('tooltip');
        const svg = document.getElementById('connectionSvg');

        // Actor positions (center of actor)
        const actorPositions = {
            'guest': {x: 100, y: 150},
            'customer': {x: 100, y: 550},
            'admin': {x: 1300, y: 450}
        };

        // Tooltip for use cases
        usecases.forEach(uc => {
            uc.addEventListener('mouseenter', (e) => {
                const desc = uc.getAttribute('data-desc');
                const text = uc.querySelector('.usecase-text').textContent;
                tooltip.innerHTML = `<strong>${text}</strong><br>${desc}`;
                tooltip.classList.add('show');
            });

            uc.addEventListener('mousemove', (e) => {
                tooltip.style.left = e.clientX + 15 + 'px';
                tooltip.style.top = e.clientY + 15 + 'px';
            });

            uc.addEventListener('mouseleave', () => {
                tooltip.classList.remove('show');
            });
        });

        // Tooltip for actors
        actors.forEach(actor => {
            actor.addEventListener('mouseenter', () => {
                const name = actor.querySelector('.actor-name').textContent;
                tooltip.innerHTML = `<strong>${name}</strong>`;
                tooltip.classList.add('show');
            });

            actor.addEventListener('mousemove', (e) => {
                tooltip.style.left = e.clientX + 15 + 'px';
                tooltip.style.top = e.clientY + 15 + 'px';
            });

            actor.addEventListener('mouseleave', () => {
                tooltip.classList.remove('show');
            });
        });

        // Draw connections
        function drawConnections() {
            svg.innerHTML = '';
            
            usecases.forEach(uc => {
                const actorAttr = uc.getAttribute('data-actor');
                if (!actorAttr) return;
                
                const actorsList = actorAttr.split(' ');
                const ucRect = uc.getBoundingClientRect();
                const containerRect = document.getElementById('diagramWrapper').getBoundingClientRect();
                
                const ucX = ucRect.left - containerRect.left + ucRect.width / 2;
                const ucY = ucRect.top - containerRect.top + ucRect.height / 2;
                
                actorsList.forEach(actorName => {
                    const actorPos = actorPositions[actorName];
                    if (!actorPos) return;
                    
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', actorPos.x);
                    line.setAttribute('y1', actorPos.y);
                    line.setAttribute('x2', ucX);
                    line.setAttribute('y2', ucY);
                    line.setAttribute('class', 'connection');
                    line.setAttribute('data-actor', actorName);
                    line.setAttribute('data-uc', uc.id);
                    svg.appendChild(line);
                });
            });

            // Include/Extend relationships (dashed lines between use cases)
            // ƒêƒÉng nh·∫≠p <<include>> X√°c th·ª±c jwt
            drawIncludeLine('uc-dangnhap', 'uc-xacthuc');
            
            // T·∫°o b√†i ƒëƒÉng <<include>> Th√¥ng tin
            drawIncludeLine('uc-taobaidang', 'uc-thongtin');
            
            // T·∫°o b√†i ƒëƒÉng <<include>> H√¨nh ·∫£nh
            drawIncludeLine('uc-taobaidang', 'uc-hinhanh');
            
            // H√¨nh ·∫£nh <<include>> Ng√†y ƒëƒÉng
            drawIncludeLine('uc-hinhanh', 'uc-ngaydang');
            
            // Duy·ªát/ch∆∞a duy·ªát <<extend>> Ng√†y ƒëƒÉng (ch·ªó n√†y g·∫ßn)
            
            // Xem tr·∫°ng th√°i b√†i ƒëƒÉng <<include>> S·ª≠a/x√≥a
            drawIncludeLine('uc-xemtrangthai', 'uc-suaxoa');
            
            // Xem b√†i ƒëƒÉng <<include>> ·∫¢nh
            drawIncludeLine('uc-xembaidang', 'uc-anh');
            
            // Xem b√†i ƒëƒÉng <<include>> Gi√°
            drawIncludeLine('uc-xembaidang', 'uc-gia');
            
            // Xem b√†i ƒëƒÉng <<include>> M√¥ t·∫£/v·ªã tr√≠
            drawIncludeLine('uc-xembaidang', 'uc-motavitri');
            
            // T√¨m ki·∫øm <<include>> L·ªçc theo gi√° ph√≤ng
            drawIncludeLine('uc-timkiem', 'uc-loctheogiaphong');
            
            // T√¨m ki·∫øm <<include>> T√¨m theo khu v·ª±c
            drawIncludeLine('uc-timkiem', 'uc-timtheokhuvuc');
        }

        function drawIncludeLine(fromId, toId, label = '') {
            const fromEl = document.getElementById(fromId);
            const toEl = document.getElementById(toId);
            if (!fromEl || !toEl) return;

            const containerRect = document.getElementById('diagramWrapper').getBoundingClientRect();
            const fromRect = fromEl.getBoundingClientRect();
            const toRect = toEl.getBoundingClientRect();

            const fromX = fromRect.left - containerRect.left + fromRect.width / 2;
            const fromY = fromRect.top - containerRect.top + fromRect.height / 2;
            const toX = toRect.left - containerRect.left + toRect.width / 2;
            const toY = toRect.top - containerRect.top + toRect.height / 2;

            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', fromX);
            line.setAttribute('y1', fromY);
            line.setAttribute('x2', toX);
            line.setAttribute('y2', toY);
            line.setAttribute('class', 'connection-include');
            svg.appendChild(line);
            
            // Add arrow at the end
            const angle = Math.atan2(toY - fromY, toX - fromX);
            const arrowSize = 8;
            const arrowX = toX - Math.cos(angle) * 15;
            const arrowY = toY - Math.sin(angle) * 15;
            
            const arrow = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            const points = [
                [arrowX, arrowY],
                [arrowX - arrowSize * Math.cos(angle - Math.PI / 6), arrowY - arrowSize * Math.sin(angle - Math.PI / 6)],
                [arrowX - arrowSize * Math.cos(angle + Math.PI / 6), arrowY - arrowSize * Math.sin(angle + Math.PI / 6)]
            ];
            arrow.setAttribute('points', points.map(p => p.join(',')).join(' '));
            arrow.setAttribute('fill', '#666');
            svg.appendChild(arrow);
        }

        // Highlight actor use cases
        function highlightActor(actorName) {
            const wrapper = document.getElementById('diagramWrapper');
            wrapper.classList.add('highlight-mode');
            
            // Reset all
            document.querySelectorAll('.active').forEach(el => el.classList.remove('active'));
            
            // Highlight actor
            const actor = document.querySelector(`#actor-${actorName}`);
            if (actor) actor.classList.add('active');
            
            // Highlight use cases
            usecases.forEach(uc => {
                const ucActors = uc.getAttribute('data-actor');
                if (ucActors && ucActors.includes(actorName)) {
                    uc.classList.add('active');
                }
            });
            
            // Highlight connections
            document.querySelectorAll('.connection').forEach(conn => {
                if (conn.getAttribute('data-actor') === actorName) {
                    conn.classList.add('active');
                }
            });
        }

        function resetView() {
            const wrapper = document.getElementById('diagramWrapper');
            wrapper.classList.remove('highlight-mode');
            document.querySelectorAll('.active').forEach(el => el.classList.remove('active'));
        }

        // Draw connections on load
        window.addEventListener('load', drawConnections);
        window.addEventListener('resize', drawConnections);
    </script>
</body>
</html>
